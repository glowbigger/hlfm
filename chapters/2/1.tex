% TODO proving a -> b from \Gamma \cup a without using the deduction theorem to internalize the theorem
% TODO prove that a -> a is a theorem alone, since it used in the deduction theorem and is a good exercise in general
% TODO 3(c) is good
% TODO 4(b) is good, very simply after double ded. thm.

\section{The formal system \texorpdfstring{\(L\)}{L}}

A \textit{formal system} is a mathematical structure representing a deductive system. It consists of
\begin{enumerate}
  \item A set of symbols called an \textit{alphabet}.

  \item A set of finite strings of these symbols representing the valid sentences in the system. Each string is called a \textit{well-formed formula}, or \textit{wf} for short.

    There is usually a formula, called a \textit{grammar}, for determining which strings are wfs.

  \item A subset of the set of wfs representing the axioms.

  \item A finite set of \textit{inference rules}, functions which take a set of \wfs{} and return a \wf{}. The returned \wf{} is said to be deduced from the set of \wfs{}.
\end{enumerate}

This chapter is devoted to a particular formal system described below.

\begin{definition}
  The \textit{formal system \(L\) of statement calculus} is defined by the following:
  \begin{enumerate}
    \item The alphabet consists of the symbols \(\sim, \ra, (,\) and \()\), along with the countably infinite set of symbols \(p_1, p_2, p_3, \dots\).

    \item The set of \wfs{} is defined recursively by the following rules:

      \begin{enumerate}
        \item For any \(i\), \(p_i\) is a \wf{}.
        
        \item If \(\cua\) and \(\cub\) are \wfs{}, then \((\sim\cua)\) and \((\cua \ra \cub)\) are \wfs{}.

          \textit{This rule also defines the semantics of the parentheses, and, because one set of parentheses will always contain only one of \(\sim\) or \(\ra\) not in parentheses, it also eliminates the need for an order of operations.}

        \item The set of all \wfs{} is generated by the above rules.
      \end{enumerate}

    \item Let \(\cua, \cub, \cuc\) be \wfs. All axioms take on one of the following forms:

      \begin{enumerate}
        \item Axiom scheme 1 (L1): \((\cua \ra (\cub \ra \cua))\).
        \item Axiom scheme 2 (L2):
          \(((\cua \ra (\cub \ra \cuc)) \ra ((\cua \ra \cub) \ra (\cua \ra \cuc)))\).
        \item Axiom scheme 3 (L3): \((((\sim\cua) \ra (\sim\cub)) \ra (\cub \ra \cua))\).
      \end{enumerate}

    \item There is one rule of deduction known as \textit{modus ponens} (MP): from \(\cua\) and \(\cua \ra \cub\), \(\cub\) is a direct consequence, where \(\cua, \cub\) are any \wfs of \(L\).
  \end{enumerate}
\end{definition}

\begin{definition}
  A \textit{proof of \(\cua_n\) in \(L\)}, or just a \textit{proof in \(L\)}, is a sequence of \wfs{} \(\cua_1, \dots, \cua_n\) such that for any \(i\), \(\cua_i\) is an axiom of \(L\) or \(\cua_i\) follows from MP and two previous \wfs{} in the sequence. The \wf{} \(\cua_n\) is said to be a \textit{theorem of \(L\)}.
\end{definition}

Instead of using the word theorem to discuss a result about formal system, we will instead use the word \textit{metatheorem} to prevent confusion with the word \textit{theorem} in the sense of the previous definition.

\setcounter{definition}{4}
\begin{definition}
  Let \(\Gamma\) be a set of \wfs{} of \(L\). A proof in \(L\) with the members of \(\Gamma\) regarded as additional axioms is called a \textit{deduction from \(\Gamma\)}. The last \wf{} in the proof, call it \(\cua\), is said to be \textit{deducible from \(\Gamma\)} or a \textit{consequence of \(\Gamma\)} and is symbolized by \(\Gamma \dedL \cua\). If \(\Gamma = \emptyset\) then we instead write \(\dedL \cua\), which is to say that \(\cua\) is a theorem of \(L\).
\end{definition}

\setcounter{definition}{7}
\begin{proposition}[The Deduction Theorem]
  If \(\Gamma \cup \{\cua\} \dedL \cub\), then \(\Gamma \dedL (\cua \ra \cub)\), where \(\cua\) and \(\cub\) are \wfs{} of \(L\), and \(\Gamma\) is a set of \wfs{} of \(L\) (possibly empty).

  \prf{} The proof is by strong induction on the number of \wfs{} in the sequence forming the deduction of \(\cub\) from \(\Gamma \cup \{\cua\}\).

  (base case) There is only one \wf{} in the deduction of \(\cub\) from \(\Gamma \cup \{\cua\}\), which is to say that the proof consists of only \(\cub\), and there are two cases in which this can happen:
  \begin{enumerate}
    \item The \wf{} \(\cub\) is an axiom of \(L\) or a member of \(\Gamma\). In either case the deduction of \(\cua \ra \cub\) proceeds as follows:
      \begin{align*}
        \text{1}&&
        \cub&&
        \text{\(\cub\) is an axiom or a member of \(\Gamma\)}\\
        %
        \text{2}&&
        (\cub \ra (\cua \ra \cub))&&
        \text{(L1)}\\
        %
        \text{3}&&
        (\cua \ra \cub)&&
        \text{1, 2, MP}
      \end{align*}
      The above is a deduction of \((\cua \ra \cub)\) from \(\Gamma\).

    \item The \wf{} \(\cub\) is \(\cua\), and so \((\cua \ra \cub)\) is \((\cua \ra \cua)\). 
      \begin{align*}
        \text{1}&&
        ((\cua \ra ((\cua \ra \cua) \ra \cua)) \ra ((\cua \ra (\cua \ra \cua)) \ra (\cua \ra \cua)))&&
        \text{(L2)}\\
        %
        \text{2}&&
        (\cua \ra ((\cua \ra \cua) \ra \cua))&&
        \text{(L1)}\\
        %
        \text{3}&&
        ((\cua \ra (\cua \ra \cua)) \ra (\cua \ra \cua))&&
        \text{1, 2, MP}\\
        %
        \text{4}&&
        (\cua \ra (\cua \ra \cua))&&
        \text{(L1)}\\
        %
        \text{5}&&
        (\cua \ra \cua)&&
        \text{3, 4, MP}
      \end{align*}
      The above is a deduction of \((\cua \ra \cub)\) (which is \((\cua \ra \cua)\)) from \(\Gamma\). Note that it is also a general theorem of \(L\).
  \end{enumerate}

  (inductive step) Suppose that for any deduction of \(\cuc\) from \(\Gamma \cup \{\cua\}\) with up to and including \(n\) members, it is possible to deduce \((\cua \ra \cub)\) from \(\Gamma\) alone. This is the hypothesis of strong induction.

  Additionally suppose that there exists a deduction of \(\cub\) from \(\Gamma \cup \{\cua\}\) with \(n + 1\) members. We now provide a proof that there exists a deduction of \((\cua \ra \cub)\) from \(\Gamma\) alone. There are three cases to consider:

  \begin{enumerate}
    \item The \wf{} \(\cub\) is an axiom of \(L\) or a member of \(\Gamma\). A deduction of \((\cua \ra \cub)\) from \(\Gamma\) is shown in case 1 in the base case.

    \item The \wf{} \(\cub\) is \(\cua\). A deduction of \((\cua \ra \cub)\) from \(\Gamma\) is shown in case 2 in the base case.

    \item The \wf{} \(\cub\) is obtained applying MP along with two \wfs{}, which are necessarily of the form \(\cuc\) and \((\cuc \ra \cub)\), where \(\cuc\) is any \wf{}. The deduction of \(\cub\) from \(\Gamma \cup \{\cua\}\) must be the sequence
      \[(\dots, \cuc, \dots, (\cuc \ra \cub), \dots, \cub) \text{ or } (\dots, (\cuc \ra \cub), \dots, \cuc, \dots, \cub),\]
    from which it can be seen that the subsequences \((\dots, \cuc)\) and \((\dots, (\cuc \ra \cub))\) are both deductions of \(\cuc\) and \((\cuc \ra \cub)\) from \(\Gamma \cup \{\cua\}\) with \(n\) members or less. Therefore, by the hypothesis, \(\Gamma \dedL (\cua \ra \cuc)\) and \(\Gamma \dedL (\cua \ra (\cuc \ra \cub))\), which is to say that \((\cua \ra \cuc)\) and \((\cua \ra (\cuc \ra \cub))\) are both deducible from \(\Gamma\) alone.

    So appending the proof of \((\cua \ra (\cuc \ra \cub))\) to \((\cua \ra \cuc)\), yields the sequence
      \[(\dots, (\cua \ra \cuc), \dots, (\cua \ra (\cuc \ra \cub))).\]
    which may have redundant \wfs{}, but is nevertheless a valid deduction from \(\Gamma\). The following proof builds on the sequence.
    \begin{align*}
      &&
      \vdots&&
      \\
      %
      \text{k}&&
      (\cua \ra \cuc)&&
      \text{deduced from \(\Gamma\)}\\
      %
      &&
      \vdots&&
      \\
      %
      \text{l}&&
      (\cua \ra (\cuc \ra \cub))&&
      \text{deduced from \(\Gamma\)}\\
      %
      \text{l + 1}&&
      ((\cua \ra (\cuc \ra \cub)) \ra ((\cua \ra \cuc) \ra (\cua \ra \cub)))&&
      \text{(L2)}\\
      %
      \text{l + 2}&&
      ((\cua \ra \cuc) \ra (\cua \ra \cub))&&
      \text{l, l + 1}\\
      %
      \text{l + 3}&&
      ((\cua \ra (\cuc \ra \cub)) \ra ((\cua \ra \cuc) \ra (\cua \ra \cub)))&&
      \text{(L2)}
    \end{align*}
  \end{enumerate}

  And so in all three cases, \((\cua \ra \cub)\) can be deduced from \(\Gamma\) alone, which concludes the induction.
\end{proposition}

\begin{proposition}[Converse of The Deduction Theorem]
  If \(\Gamma \dedL (\cua \ra \cub)\) then \(\Gamma \cup \{\cua\} \dedL \cub\), where \(\cua\) and \(\cub\) are \wfs{} of \(L\) and \(\Gamma\) is a (possibly empty) set of \wfs{} of \(L\).

  \prf{} The following is a deduction of \(\cub\) from \(\Gamma \cup \{\cua\}\), provided that \(\Gamma \dedL (\cua \ra \cub)\).
  \begin{align*}
    &&
    \vdots&&
    \\
    %
    \text{k}&&
    (\cua \ra \cub)&&
    \text{deduction from \(\Gamma\)}\\
    %
    \text{k + 1}&&
    \cua&&
    \text{member of \(\Gamma \cup \{\cua\}\)}\\
    %
    \text{k + 2}&&
    \cub&&
    \text{k, k + 1, MP}
  \end{align*}
\end{proposition}

\begin{corollary}[The Hypothetical Syllogism (HS)]
  For any \wfs{} \(\cua, \cub, \cuc\) of \(L\),
  \[\{(\cua \ra \cub), (\cub \ra \cuc)\} \dedL (\cua \ra \cuc).\]
  \prf{} We will first prove \(S \dedL \cuc\), where \(S = \{(\cua \ra \cub), (\cub \ra \cuc)\} \cup \{\cua\}\).
  \begin{align*}
    \text{1}&&
    \cua \ra \cub&&
    \text{member of \(S\)}\\
    %
    \text{2}&&
    \cub \ra \cuc&&
    \text{member of \(S\)}\\
    %
    \text{3}&&
    \cua&&
    \text{member of \(S\)}\\
    %
    \text{4}&&
    \cub&&
    \text{1, 3, MP}\\
    %
    \text{5}&&
    \cuc&&
    \text{2, 4, MP}
  \end{align*}
  Seeing as though we have proved
    \[\{(\cua \ra \cub), (\cub \ra \cuc)\} \cup \{\cua\} \dedL \cuc\]
  we may use the deduction theorem to conclude
    \[\{(\cua \ra \cub), (\cub \ra \cuc)\} \dedL (\cua \ra \cuc).\]
\end{corollary}

\begin{proposition}
  For any \wfs{} \(\cua\) and \(\cub\) of \(L\), the following are theorems of \(L\).
  \begin{enumerate}[label=(\alph*), align=left]
    \item \(((\sim\cua) \ra (\cub \ra \cua))\)
    \item \((((\sim\cua) \ra \cua) \ra \cua)\)
  \end{enumerate}
  \prf{}
  \begin{enumerate}[label=(\alph*), align=left]
    \item
      \centeredAlign{
        \text{1}&&
        ((\sim\cub) \ra ((\sim\cua) \ra (\sim\cub)))&&
        \text{(L1)}\\
        %
        \text{2}&&
        (((\sim\cua) \ra (\sim\cub)) \ra (\cub \ra \cua))&&
        \text{(L3)}
      }

      Application of HS and the above two lines yields \(((\sim\cub) \ra (\cub \ra \cua))\), as desired.

    \item We will first prove that \(\{((\sim\cua) \ra \cua)\} \dedL \cua\).

      \centeredAlign{
        \text{1}&&
        ((\sim\cua) \ra \cua)&&
        \text{assumption}\\
        %
        \text{2}&&
        ((\sim\cua) \ra ((\sim(\sim((\sim\cua) \ra \cua))) \ra (\sim\cua)))&&
        \text{(L1)}\\
        %
        \text{3}&&
        (((\sim(\sim((\sim\cua) \ra \cua))) \ra (\sim\cua)) \ra&&
        \\
        &&
        (\cua \ra (\sim((\sim\cua) \ra \cua))))&&
        \text{(L3)}\\
        %
        \text{4}&&
        ((\sim \cua) \ra (\cua \ra (\sim((\sim \cua) \ra \cua))))&&
        \text{2, 3, HS}\\
        %
        \text{5}&&
        (((\sim\cua) \ra (\cua \ra (\sim((\sim\cua) \ra \cua)))) \ra&&
        \\
        &&
        (((\sim \cua) \ra \cua) \ra ((\sim \cua) \ra (\sim((\sim\cua) \ra \cua)))))&&
        \text{(L2)}\\
        %
        \text{6}&&
        (((\sim \cua) \ra \cua) \ra ((\sim \cua) \ra (\sim((\sim\cua) \ra \cua))))&&
        \text{4, 5, MP}\\
        %
        \text{7}&&
        ((\sim \cua) \ra (\sim((\sim\cua) \ra \cua)))&&
        \text{1, 6, MP}\\
        %
        \text{8}&&
        (((\sim \cua) \ra (\sim((\sim\cua) \ra \cua))) \ra
        \\
        &&
        (((\sim\cua) \ra \cua) \ra \cua))&&
        \text{(L3)}\\
        %
        \text{9}&&
        (((\sim\cua) \ra \cua) \ra \cua)&&
        \text{7, 8, MP}\\
        %
        \text{10}&&
        \cua&&
        \text{1, 9, MP}
      }

      By the deduction theorem, we may conclude that \((((\sim\cua) \ra \cua) \ra \cua)\).

      \note{} Because of the use of HS in line 4, which is a metatheorem, the above proof is not technically a proof in \(L\). An actual proof would require a few additional lines.
  \end{enumerate}
\end{proposition}

\solutions{}

\note{} All formulas are fully parenthesized, so they may look different from how they appear in the book. Additionally, any metatheorems are referenced as if they were rules of deduction, just like in the book.
%
\begin{enumerate}
  \item % 1 
    \begin{enumerate}[label=(\alph*), align=left]
      % a
      \item
        \centeredAlign{
          \text{1}&&
          ((\sim p_1 \ra \sim p_2) \ra (p_2 \ra p_1))&&
          \text{(L3)}\\
          %
          \text{2}&&
          (((\sim p_1 \ra \sim p_2) \ra (p_2 \ra p_1)) \ra&&
          \\
          &&
          ((p_1 \ra p_2) \ra ((\sim p_1 \ra \sim p_2) \ra (p_2 \ra p_1))))&&
          \text{(L1)}\\
          \text{3}&&
          ((p_1 \ra p_2) \ra ((\sim p_1 \ra \sim p_2) \ra (p_2 \ra p_1)))&&
          \text{1, 2, MP}
        }

      % b
      \item \footnotesize
        \centeredAlign{
          \text{1}&&
          ((\underbrace{(p_1 \ra (p_2 \ra p_3))}_{\cua} \ra (\underbrace{(p_1 \ra p_2)}_{\cub} \ra \underbrace{(p_1 \ra p_3)}_{\cuc})) \ra&&
          \\
          &&
          (((p_1 \ra (p_2 \ra p_3)) \ra (p_1 \ra p_2)) \ra ((p_1 \ra (p_2 \ra p_3)) \ra (p_1 \ra p_3))))&&
          \text{(L2)}\\
          %
          \text{2}&&
          ((p_1 \ra (p_2 \ra p_3)) \ra ((p_1 \ra p_2) \ra (p_1 \ra p_3)))&&
          \text{(L2)}\\
          %
          \text{3}&&
          (((p_1 \ra (p_2 \ra p_3)) \ra (p_1 \ra p_2)) \ra ((p_1 \ra (p_2 \ra p_3)) \ra (p_1 \ra p_3)))&&
          \text{1, 2, MP}\\
        }
      \normalsize

      % c
      \item \footnotesize
        \centeredAlign{
          \text{1}&&
          ((\underbrace{(p_1 \ra (p_1 \ra p_2))}_{\cua} \ra (\underbrace{(p_1 \ra p_1)}_{\cub} \ra \underbrace{(p_1 \ra p_2)}_{\cuc})) \ra&&
          \\
          &&
          (((p_1 \ra (p_1 \ra p_2)) \ra (p_1 \ra p_1)) \ra ((p_1 \ra (p_1 \ra p_2)) \ra (p_1 \ra p_2))))&&
          \text{(L2)}\\
          %
          \text{2}&&
          ((p_1 \ra (p_1 \ra p_2)) \ra ((p_1 \ra p_1) \ra (p_1 \ra p_2)))&&
          \text{(L2)}\\
          %
          \text{3}&&
          (((p_1 \ra (p_1 \ra p_2)) \ra (p_1 \ra p_1)) \ra ((p_1 \ra (p_1 \ra p_2)) \ra (p_1 \ra p_2)))&&
          \text{1, 2, MP}\\
          %
          \text{4}&&
          (p_1 \ra ((p_1 \ra p_2) \ra p_1))&&
          \text{(L1)}\\
          %
          \text{5}&&
          ((p_1 \ra ((p_1 \ra p_2) \ra p_1)) \ra ((p_1 \ra (p_1 \ra p_2)) \ra (p_1 \ra p_1)))&&
          \text{(L2)}\\
          %
          \text{6}&&
          ((p_1 \ra (p_1 \ra p_2)) \ra (p_1 \ra p_1))&&
          \text{4, 5, MP}\\
          %
          \text{7}&&
          ((p_1 \ra (p_1 \ra p_2)) \ra (p_1 \ra p_2))&&
          \text{3, 6, MP}
        }

        Lines 1-3 are identical to exercise (b) with \(p_1\) substituted for \(p_2\) and \(p_2\) substituted for \(p_3\).

        Lines 4-6 are identical to example 2.4 in the book with \((p_1 \ra p_2)\) substituted for \(p_2\).
      \normalsize

      % d
      \item
        \centeredAlign{
          \text{1}&&
          (p_2 \ra (p_1 \ra p_2))&&
          \text{(L1)}\\
          %
          \text{2}&&
          (\underbrace{(p_2 \ra (p_1 \ra p_2))}_{\cua} \ra (\underbrace{p_1}_{\cub} \ra \underbrace{(p_2 \ra (p_1 \ra p_2))}_{\cua}))&&
          \text{(L1)}\\
          %
          \text{3}&&
          (p_1 \ra (p_2 \ra (p_1 \ra p_2))&&
          \text{1, 2, MP}
        }

        % TODO just write the original problems and stop substituting variables, it will make things easier
    \end{enumerate}

  \item % 2
    \begin{enumerate}[label=(\alph*), align=left]
      \item \centeredAlign{
          \text{1}&&
          (\sim\cua)&&
          \text{assumption}\\
          %
          \text{2}&&
          (((\sim\cub) \ra (\sim\cua)) \ra (\cua \ra \cub))&&
          \text{(L3)}\\
          %
          \text{3}&&
          ((\sim\cua) \ra ((\sim\cub) \ra (\sim\cua)))&&
          \text{(L1)}\\
          %
          \text{4}&&
          ((\sim\cub) \ra (\sim\cua))&&
          \text{1, 3, MP}\\
          %
          \text{5}&&
          (\cua \ra \cub)&&
          \text{2, 4, MP}
        }

      \item \centeredAlign{
          \text{1}&&
          (\sim(\sim\cua))&&
          \text{assumption}\\
          %
          \text{2}&&
          (((\sim\cua) \ra (\sim(\sim(\sim\cua)))) \ra ((\sim(\sim\cua)) \ra \cua)&&
          \text{(L3)}\\
          %
          \text{3}&&
          (((\sim(\sim(\sim(\sim\cua)))) \ra (\sim(\sim\cua))) \ra
          \\
          &&
          ((\sim\cua) \ra (\sim(\sim(\sim(\cua))))))&&
          \text{(L3)}\\
          %
          \text{4}&&
          ((\sim(\sim\cua)) \ra ((\sim(\sim(\sim(\sim\cua)))) \ra (\sim(\sim\cua))))&&
          \text{(L1)}\\
          %
          \text{5}&&
          ((\sim(\sim(\sim(\sim\cua)))) \ra (\sim(\sim\cua)))&&
          \text{1, 4, MP}\\
          %
          \text{6}&&
          ((\sim\cua) \ra (\sim(\sim(\sim\cua))))&&
          \text{3, 5, MP}\\
          %
          \text{7}&&
          ((\sim(\sim\cua)) \ra \cua)&&
          \text{2, 6, MP}\\
          %
          \text{8}&&
          \cua&&
          \text{1, 7, MP}
        }

      \item
        \centeredAlign{
          \text{1}&&
          (\cua \ra \cub)&&
          \text{assumption}\\
          %
          \text{2}&&
          (\sim(\cub \ra \cuc) \ra (\sim\cua))&&
          \text{assumption}\\
          %
          \text{3}&&
          (((\sim(\cub \ra \cuc)) \ra (\sim\cua)) \ra (\cua \ra (\cub \ra \cuc)))&&
          \text{(L3)}\\
          %
          \text{4}&&
          (\cua \ra (\cub \ra \cuc))&&
          \text{2, 3, MP}\\
          %
          \text{5}&&
          ((\cua \ra (\cub \ra \cuc)) \ra ((\cua \ra \cub) \ra (\cua \ra \cuc)))&&
          \text{(L2)}\\
          %
          \text{6}&&
          ((\cua \ra \cub) \ra (\cua \ra \cuc))&&
          \text{4, 5, MP}\\
          %
          \text{7}&&
          (\cua \ra \cuc)&&
          \text{1, 6, MP}
        }
        
      \item \centeredAlign{
          \text{1}&&
          (\cua \ra (\cub \ra \cuc))&&
          \text{assumption}\\
          %
          \text{2}&&
          ((\cua \ra (\cub \ra \cuc)) \ra ((\cua \ra \cub) \ra (\cua \ra \cuc)))&&
          \text{(L2)}\\
          %
          \text{3}&&
          ((\cua \ra \cub) \ra (\cua \ra \cuc))&&
          \text{1, 2, MP}\\
          %
          \text{4}&&
          (\cub \ra (\cua \ra \cub))&&
          \text{(L1)}\\
          %
          \text{5}&&
          (\cub \ra (\cua \ra \cuc))&&
          \text{3, 4, HS}
        }
    \end{enumerate}

  \item % 3
    \begin{enumerate}[label=(\alph*), align=left]
      \item We apply the deduction theorem to exercise to the result of exercise 2(b) and get \(\dedL (\sim(\sim\cua) \ra \cua)\), which will be referred to as \(\star\).
        \begin{align*}
          \text{1}&&
          \cua&&
          \text{assumption}\\
          %
          \text{2}&&
          (\sim(\sim(\sim\cua)) \ra (\sim\cua))&&
          \star\\
          %
          \text{3}&&
          ((\sim(\sim(\sim\cua)) \ra (\sim\cua)) \ra (\cua \ra (\sim(\sim\cua))))&&
          \text{(L3)}\\
          %
          \text{4}&&
          (\cua \ra (\sim(\sim\cua)))&&
          \text{2, 3, MP}\\
          %
          \text{5}&&
          (\sim(\sim\cua))&&
          \text{1, 4, MP}
        \end{align*}
      By the deduction theorem, \(\dedL (\cua \ra (\sim(\sim\cua)))\).

      \item This solution relies on the solutions for 3(a) and 2(b).
        \begin{align*}
          \text{1}&&
          (\cub \ra \cua)&&
          \text{assumption}\\
          %
          \text{2}&&
          (\cua \ra (\sim(\sim\cua)))&&
          \star\\
          %
          \text{3}&&
          ((\sim(\sim\cub)) \ra \cub)&&
          \text{exercise 3(a)}\\
          %
          \text{4}&&
          (\cub \ra (\sim(\sim\cua)))&&
          \text{1, 2, HP}\\
          %
          \text{5}&&
          ((\sim(\sim\cub)) \ra (\sim(\sim\cua)))&&
          \text{3, 4, HP}\\
          %
          \text{6}&&
          (((\sim(\sim\cub)) \ra (\sim(\sim\cua))) \ra ((\sim\cua) \ra (\sim\cub)))&&
          \text{(L3)}\\
          %
          \text{7}&&
          ((\sim\cua) \ra (\sim\cub))&&
          \text{5, 6, MP}
        \end{align*}
        By the deduction theorem, \(\dedL ((\cub \ra \cua) \ra ((\sim\cua) \ra (\sim\cub)))\).

      \item
        \centeredAlign{
          \text{1}&&
          ((\cua \ra \cub) \ra \cua)&&
          \text{assumption}\\
          %
          \text{2}&&
          ((\sim\cua) \ra (\cua \ra \cub))&&
          \text{Proposition 2.11(a)}\\
          %
          \text{3}&&
          (\sim\cua \ra \cua)&&
          \text{1, 2, HS}\\
          %
          \text{4}&&
          ((\sim\cua \ra \cua) \ra \cua)&&
          \text{Proposition 2.11(b)}\\
          %
          \text{5}&&
          \cua&&
          \text{3, 4, MP}
        }

        By the deduction theorem, \(\dedL (((\cua \ra \cub) \ra \cua) \ra \cua)\).
        
      \item \centeredAlign{
          \text{1}&&
          (\sim(\cua \ra \cub))&&
          \text{assumption}\\
          %
          \text{2}&&
          ((\cub \ra (\cua \ra \cub)) \ra (\sim(\cua \ra \cub) \ra (\sim\cub)))&&
          \text{exercise 3(b)}\\
          %
          \text{3}&&
          (\cub \ra (\cua \ra \cub))&&
          \text{(L1)}\\
          %
          \text{4}&&
          (\sim(\cua \ra \cub) \ra (\sim\cub))&&
          \text{2, 3, MP}\\
          %
          \text{5}&&
          (\sim\cub)&&
          \text{1, 4, MP}\\
          %
          \text{6}&&
          (\sim\cub \ra (\cub \ra \cua))&&
          \text{Proposition 2.11(a)}\\
          %
          \text{7}&&
          (\cub \ra \cua)&&
          \text{5, 6, MP}
        }

        By the deduction theorem, \(\dedL ((\sim(\cua \ra \cub)) \ra (\cub \ra \cua))\).
    \end{enumerate}

  \item % 4
    \begin{enumerate}[(i)]
      \item \centeredAlign{
          \text{1}&&
          ((\sim\cua) \ra (\sim\cub))&&
          \text{assumption}\\
          %
          \text{2}&&
          ((\sim\cua) \ra \cub)&&
          \text{assumption}\\
          %
          \text{3}&&
          (((\sim\cua) \ra (\sim\cub)) \ra (\cub \ra \cua))&&
          \text{(L3)}\\
          %
          \text{4}&&
          (\cub \ra \cua)&&
          \text{1, 3, MP}\\
          %
          \text{5}&&
          ((\sim\cua) \ra \cua)&&
          \text{2, 4, HS}\\
          %
          \text{6}&&
          (((\sim\cua) \ra \cua) \ra \cua)&&
          \text{2.11(b)}\\
          %
          \text{7}&&
          \cua&&
          \text{5, 6, MP}
        }

        By the deduction theorem, which is valid since its proof relies only on \((L'1)\) and \((L'2)\), \(\ded{L'} (((\sim\cua) \ra (\sim\cub)) \ra (((\sim\cua) \ra \cub) \ra \cua))\).

      \item We will prove \(\{((\sim\cua) \ra (\sim\cub)), \cub\} \ded{L'} \cua\)
        \begin{align*}
          \text{1}&&
          ((\sim\cua) \ra (\sim\cub))&&
          \text{assumption}\\
          %
          \text{2}&&
          \cub&&
          \text{assumption}\\
          %
          \text{3}&&
          (((\sim\cua) \ra (\sim\cub)) \ra (((\sim\cua) \ra \cub) \ra \cua))&&
          \text{(L'3)}\\
          %
          \text{4}&&
          (((\sim\cua) \ra \cub) \ra \cua)&&
          \text{1, 3, MP}\\
          %
          \text{5}&&
          (\cub \ra ((\sim\cua) \ra \cub))&&
          \text{(L'2)}\\
          %
          \text{6}&&
          ((\sim\cua) \ra \cub)&&
          \text{2, 5, MP}\\
          %
          \text{7}&&
          \cua&&
          \text{4, 6, MP}
        \end{align*}

        By the deduction theorem twice, \(\ded{L'} (((\sim\cua) \ra (\sim\cub)) \ra (\cub \ra \cua))\).
    \end{enumerate}
    Suppose a \wf is proved in \(L\). By definition, it follows from (L1), (L2), and (L3) and MP. Since (L1), (L2) and MP are properties of \(L'\), and since we just proved that \(\ded{L'} \text{(L3)}\), the \wf can also be proved in \(L'\). The other direction is argued for in the same way, so a \wf is a theorem in \(L\) if and only if it is a theorem in \(L'\).

  \item % 5
    The rule is valid, see example 2.6 (where \(\cua\) and \(\cub\) in the exercise appear switched in the example).
\end{enumerate}
